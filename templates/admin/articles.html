{% extends "layout.html" %}

{% block title %}Статті — ВПФК{% endblock %}

{% block content %}
  <section class="section">
    <div class="container admin-shell">
      <div class="admin-header">
        <div>
          <h1>Статті</h1>
          <p>Оголошення, події та новини з датами публікації.</p>
        </div>
        <a class="btn primary" href="{{ url_for('admin_article_new') }}">Нова стаття</a>
      </div>

      <div class="table-wrap">
        <table class="table admin-table admin-articles-table">
          <thead>
            <tr>
              <th>Зображення</th>
              <th>Назва</th>
              <th>Категорія</th>
              <th>Розділ</th>
              <th>Публікація</th>
              <th>Дата події</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            {% for article in articles %}
              <tr>
                <td class="article-thumb-cell cell-no-label" data-label="Зображення">
                  {% if article.featured_image %}
                    <img src="{{ uploads_url(article.featured_image) }}" class="table-thumb" alt="{{ article.title }}">
                  {% elif article.image_gallery %}
                    {% set gallery = article.image_gallery|from_json if article.image_gallery else [] %}
                    {% if gallery %}
                      <img src="{{ uploads_url(gallery[0]) }}" class="table-thumb" alt="{{ article.title }}">
                    {% else %}
                      <div class="table-thumb-placeholder">Немає</div>
                    {% endif %}
                  {% else %}
                    <div class="table-thumb-placeholder">Немає</div>
                  {% endif %}
                </td>
                <td data-label="Назва">{{ article.title }}</td>
                <td data-label="Категорія"><span class="badge">{{ article.category }}</span></td>
                <td data-label="Розділ">{{ article.section_title or '-' }}</td>
                <td data-label="Публікація">{{ article.published_date }}</td>
                <td data-label="Дата події">{{ article.event_date or '-' }}</td>
                <td class="table-actions" data-label="Дії">
                  <a class="link" href="{{ url_for('admin_article_edit', article_id=article.id) }}">Редагувати</a>
                  <form method="post" action="{{ url_for('admin_article_delete', article_id=article.id) }}">
                    <button class="link danger" type="submit">Видалити</button>
                  </form>
                </td>
              </tr>
            {% else %}
              <tr class="table-empty">
                <td colspan="7">Немає статей.</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </section>
{% endblock %}
