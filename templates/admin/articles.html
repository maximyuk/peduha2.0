{% extends "layout.html" %}

{% block title %}Статті — ВПФК{% endblock %}

{% block content %}
  <section class="section">
    <div class="container admin-shell">
      <div class="admin-header">
        <div>
          <h1>Статті</h1>
          <p>Оголошення, події та новини з датами публікації.</p>
        </div>
        <a class="btn primary" href="{{ url_for('admin_article_new') }}">Нова стаття</a>
      </div>

      <div class="table-wrap">
        <table class="table">
          <thead>
            <tr>
              <th>Зображення</th>
              <th>Назва</th>
              <th>Категорія</th>
              <th>Розділ</th>
              <th>Публікація</th>
              <th>Дата події</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            {% for article in articles %}
              <tr>
                <td>
                  {% if article.featured_image %}
                    <img src="{{ uploads_url(article.featured_image) }}" 
                         style="width: 60px; height: 45px; object-fit: cover; border-radius: 4px;" 
                         alt="{{ article.title }}">
                  {% elif article.image_gallery %}
                    {% set gallery = article.image_gallery|from_json if article.image_gallery else [] %}
                    {% if gallery %}
                      <img src="{{ uploads_url(gallery[0]) }}" 
                           style="width: 60px; height: 45px; object-fit: cover; border-radius: 4px;" 
                           alt="{{ article.title }}">
                    {% else %}
                      <div style="width: 60px; height: 45px; background: #f0f0f0; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: #999; font-size: 10px;">Немає</div>
                    {% endif %}
                  {% else %}
                    <div style="width: 60px; height: 45px; background: #f0f0f0; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: #999; font-size: 10px;">Немає</div>
                  {% endif %}
                </td>
                <td>{{ article.title }}</td>
                <td><span class="badge">{{ article.category }}</span></td>
                <td>{{ article.section_title or '-' }}</td>
                <td>{{ article.published_date }}</td>
                <td>{{ article.event_date or '-' }}</td>
                <td class="table-actions">
                  <a class="link" href="{{ url_for('admin_article_edit', article_id=article.id) }}">Редагувати</a>
                  <form method="post" action="{{ url_for('admin_article_delete', article_id=article.id) }}">
                    <button class="link danger" type="submit">Видалити</button>
                  </form>
                </td>
              </tr>
            {% else %}
              <tr>
                <td colspan="7">Немає статей.</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </section>
{% endblock %}
